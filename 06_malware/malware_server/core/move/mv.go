package move

import (
	"bufio"
	"fmt"
	"net"
	"os"
	"strings"
)

func Navigate_file_system(connection net.Conn) (err error) {
	connection_reader := bufio.NewReader(connection)

	initial_pwd_raw, err := connection_reader.ReadString('\n')

	initial_pwd := strings.TrimSuffix(initial_pwd_raw, "\n")
	loopControl := true
	for loopControl {
		fmt.Print(initial_pwd, " >> ")

		CommandReader := bufio.NewReader(os.Stdin)

		user_command_raw, err := CommandReader.ReadString('\n')
		if err != nil {
			fmt.Println("[+] Unable to read command ")
		}

		connection.Write([]byte(user_command_raw))

		if user_command_raw == "stop\n" {
			loopControl = false
			break
		}

		new_pwd, _ := connection_reader.ReadString('\n')
		fmt.Println("[+] Working Directory changed to ", new_pwd)
		initial_pwd = new_pwd
	}
	return
}
